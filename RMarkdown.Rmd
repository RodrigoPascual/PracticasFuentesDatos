---
title: "RMarkdown"
output:
  html_document: default
  word_document: default
date: "2022-10-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# SEMINARIO FUENTES DE BASES DE DATOS
# Relacion del sedentarismo con enfermedades

## Introduccion

Vamos ha relacionar el grado de implicación del sedentarismo en una serie de enfermedades crónicas, para ello hemos escojido dos informes del centro Nacional de Estadístaca español, la primera tabla "enfermedades_cronicas" contendrá una una lista con la tasa de enfermededes crónicas según el sexo y la comunidad autónoma, como hay muchas enfermedades seleccionaremos unas pocas que sean de interés para nuestro estudio y trataremos de encontar si hay relación o no con nuestra segunda tabla "sedentarismo" que nos aportará el índice de este según de nuevo el sexo y la comunidad autónoma.


## Objetivos(max. 3):para cada objetivo un metodo y un resultado



## Métodos:
### Paquetes usadas:
```{r}
library(readr)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(forcats)
library(hrbrthemes)
library(viridis)
library(leaflet)
```



# Resultados y Analisis de los resultados
presentando las dos tablas con las cual vamos a sacar los resultados

```{r}
enfermedades <- read_delim(file = "input/enfermedades_cronicas1.csv",delim = ";",show_col_types = FALSE)
sedentarismo <- read_delim(file = "input/sedentarismo.csv",delim = ";",show_col_types = FALSE)

```

PIMERA GRAFICA

gráficas por comunidad, sexo y enfermedad padecida
Indica en cada comunidad autónoma que enfermedad es mas padecida según cada sexo


```{r}
#Paso de enfermedades y sedentarismo a data frame para hacer el join
enfermedades <- data.frame(enfermedades)
sedentarismo <-data.frame(sedentarismo)

#Cambiamos la columna de Total de str a numeric
#sedentarismo<- sedentarismo%>%
#  transmute(Sexo, Comunidades.y.Ciudades.Autónomas,Sí.o.no, Total = as.numeric(Total))

#enfermedades<- enfermedades%>%
 # transmute(Sexo, Comunidades.y.Ciudades.Autónomas, Enfermedades, Sí.o.no, Total = as.numeric(Total))
```


###hacemos un full join con los data frames anteriores a partir de las columnas Sexo, Comunidades.y.Ciudades.Autónomas y Si.o.no
```{r}
data <- full_join(x = enfermedades, 
            y = sedentarismo,
            by = c("Sexo", "Comunidades.y.Ciudades.Autónomas" ,"Sí.o.no"))

```
####Filtramos la tabla anterior solo por las enfermedades que vamos a estudiar

```{r}
data_menosEnfermedades <- data %>% 
  filter(Enfermedades == "Tensión alta" | Enfermedades == "Varices en las piernas" | Enfermedades == "Migraña o dolor de cabeza frecuente" | Enfermedades == "Ictus (embolia, infarto cerebral, hemorragia cerebral)" | Enfermedades =="Hemorroides" | Enfermedades == "Osteoporosis")

```

####Tabla de solo las personas que padecen la enfermedad
```{r}
data_soloSi <- data_menosEnfermedades %>% filter(Sí.o.no == "Sí")
```

###gráficas por comunidad, sexo y enfermedad padecida
###Indica en cada comunidad autónoma que enfermedad es mas padecida según cada sexo

```{r}
ggplot(data = data_soloSi, aes(x = Total.x, y = Enfermedades)) +
  geom_point(aes(colour = factor(Sexo))) +
  facet_wrap(~ Comunidades.y.Ciudades.Autónomas)
```

Filtramos la tabla para que no salga al representar la gráfica el total

```{r}
data_sedentarismo <- data_menosEnfermedades %>% filter(Sí.o.no == "Sí" | Sí.o.no == "No")
```


gráficas por comunidad, sexo y sedentarismo
Indica en cada comunidad autónoma que sexo es más sedentario ademas de que comunidad autonoma es mas sedentaria en general

```{r}
ggplot(data = data_sedentarismo, aes(x = Total.y, y = Sí.o.no)) +
  geom_point(aes(colour = factor(Sexo))) +
  facet_wrap(~ Comunidades.y.Ciudades.Autónomas)
```


grafica de dispersión:
Sedentarismo en funcion de la enfermedad

```{r}
ggplot(data = data_soloSi, aes(x = Total.x, y = Total.y))+  
  geom_point(aes(colour = Enfermedades))+  geom_smooth(colour = "red", linewidth = 1.75)+  
  labs(x = "Enfermos", y = "Sedentarios")
```






Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
